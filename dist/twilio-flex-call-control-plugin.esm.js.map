{"version":3,"file":"twilio-flex-call-control-plugin.esm.js","sources":["../src/components/CallControl/CallState.js","../src/components/CallControl/index.js","../src/store/call/actions.js","../src/store/call/resolver.js","../src/store/devices/actions.js","../src/store/devices/resolver.js","../src/store/sdk/actions.js","../src/store/sdk/resolver.js","../src/store/reducer.js","../src/store/index.js","../src/components/DeviceSelector/styles.js","../src/components/DeviceSelector/index.js","../src/components/DeviceIndicator/styles.js","../src/components/Logo/index.js","../src/components/DeviceIndicator/index.js","../src/plugin.js"],"sourcesContent":["import * as jabra from \"@gnaudio/jabra-browser-integration\";\r\nimport { connect } from \"react-redux\";\r\n\r\nconst mapStateToProps = ({ flex }) => ({\r\n  available: flex.worker.activity.available\r\n});\r\n\r\nconst CallState = ({ available, callState, activeDevice }) => {\r\n  if (!activeDevice) return null;\r\n\r\n  if (available && callState === \"incoming\") {\r\n    jabra.ring();\r\n    return null;\r\n  }\r\n\r\n  if (available && callState === \"accepted\") {\r\n    jabra.offHook();\r\n    return null;\r\n  }\r\n\r\n  jabra.onHook();\r\n\r\n  return null;\r\n};\r\n\r\nexport default connect(mapStateToProps)(CallState);\r\n","import React from \"react\";\r\nimport { connect } from \"react-redux\";\r\n\r\nimport CallState from \"./CallState\";\r\n\r\nconst CallControl = connect(({ jabra }) => ({ jabra }))(({ jabra }) => {\r\n  return (\r\n    <CallState\r\n      callState={jabra.call.state}\r\n      activeDevice={jabra.devices.active}\r\n    />\r\n  );\r\n});\r\n\r\nexport default CallControl;\r\n","export const SET_CALL_STATE = \"SET_CALL_STATE\";\n\nexport const setCallState = state => ({ type: SET_CALL_STATE, payload: state });\n","import { SET_CALL_STATE } from \"./actions\";\n\nconst initialState = {\n  state: \"none\",\n  reservation: null\n};\n\nexport function call(state = initialState, action) {\n  switch (action.type) {\n    case SET_CALL_STATE:\n      return {\n        ...state,\n        state: action.payload\n      };\n\n    default:\n      return state;\n  }\n}\n","import * as Flex from \"@twilio/flex-ui\";\r\nimport * as jabra from \"@gnaudio/jabra-browser-integration\";\r\n\r\nexport const LOAD_DEVICES = \"LOAD_DEVICES\";\r\nexport const SET_ACTIVE_DEVICE = \"SET_ACTIVE_DEVICE\";\r\nexport const REMOVE_ACTIVE_DEVICE = \"REMOVE_ACTIVE_DEVICE\";\r\n\r\nexport const loadDevices = () => async (dispatch, getState) => {\r\n  const { active } = getState().jabra.devices;\r\n\r\n  try {\r\n    const devices = await jabra.getDevices();\r\n\r\n    // If no active device set the first device as the active one\r\n    if (!active) {\r\n      const device = await jabra.getActiveDevice();\r\n\r\n      dispatch(setActiveDevice(device.deviceID));\r\n    }\r\n    // If the devices list no longer contains the active device\r\n    else if (!devices.some(device => device.deviceID === active.deviceID)) {\r\n      // If there is more devices available, set the first one as the new active\r\n      // device\r\n      if (devices.length > 0) {\r\n        dispatch(setActiveDevice(devices[0].deviceID));\r\n      } else {\r\n        dispatch(removeActiveDevice());\r\n      }\r\n    }\r\n\r\n    dispatch({ type: LOAD_DEVICES, status: \"success\", payload: devices });\r\n  } catch (error) {\r\n    dispatch({ type: LOAD_DEVICES, status: \"error\", payload: error });\r\n  }\r\n};\r\n\r\nexport const setActiveDevice = id => async dispatch => {\r\n  try {\r\n    await jabra.setActiveDeviceId(id);\r\n\r\n    const device = await jabra.getActiveDevice();\r\n\r\n    // Set the active jabra device as the device used in Twilio Flex\r\n    if (window.location.protocol === \"https:\") {\r\n      const manager = Flex.Manager.getInstance();\r\n      const { deviceInfo } = await jabra.getUserDeviceMediaExt({\r\n        audio: true\r\n      });\r\n\r\n      await manager.voiceClient.audio.setInputDevice(\r\n        deviceInfo.browserAudioInputId\r\n      );\r\n\r\n      await manager.voiceClient.audio.speakerDevices.set(\r\n        deviceInfo.browserAudioOutputId\r\n      );\r\n    }\r\n\r\n    dispatch({ type: SET_ACTIVE_DEVICE, status: \"success\", payload: device });\r\n  } catch (error) {\r\n    dispatch({ type: SET_ACTIVE_DEVICE, status: \"error\", payload: error });\r\n  }\r\n};\r\n\r\nexport const removeActiveDevice = () => ({ type: REMOVE_ACTIVE_DEVICE });\r\n","import {\r\n  LOAD_DEVICES,\r\n  SET_ACTIVE_DEVICE,\r\n  REMOVE_ACTIVE_DEVICE\r\n} from \"./actions\";\r\n\r\nconst initialState = {\r\n  items: [],\r\n  active: null\r\n};\r\n\r\nexport function devices(state = initialState, action) {\r\n  switch (action.type) {\r\n    case LOAD_DEVICES:\r\n      if (action.status === \"success\")\r\n        return {\r\n          ...state,\r\n          items: action.payload\r\n        };\r\n      break;\r\n\r\n    case SET_ACTIVE_DEVICE:\r\n      if (action.status === \"success\")\r\n        return {\r\n          ...state,\r\n          active: action.payload\r\n        };\r\n      break;\r\n\r\n    case REMOVE_ACTIVE_DEVICE:\r\n      return {\r\n        ...state,\r\n        active: null\r\n      };\r\n\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n","import * as jabra from \"@gnaudio/jabra-browser-integration\";\r\n\r\nimport { loadDevices } from \"../devices/actions\";\r\n\r\nexport const INITIALIZE_REQUEST = \"INITIALIZE_REQUEST\";\r\nexport const INITIALIZE_FAILURE = \"INITIALIZE_FAILURE\";\r\nexport const INITIALIZE_SUCCESS = \"INITIALIZE_SUCCESS\";\r\n\r\nexport const initialize = () => async dispatch => {\r\n  dispatch({ type: INITIALIZE_REQUEST });\r\n\r\n  try {\r\n    await jabra.init();\r\n    await dispatch(loadDevices());\r\n\r\n    dispatch({ type: INITIALIZE_SUCCESS });\r\n  } catch (error) {\r\n    dispatch({ type: INITIALIZE_FAILURE, payload: error });\r\n  }\r\n};\r\n","import {\r\n  INITIALIZE_REQUEST,\r\n  INITIALIZE_SUCCESS,\r\n  INITIALIZE_FAILURE\r\n} from \"./actions\";\r\n\r\nconst initialState = {\r\n  isInitialized: false,\r\n  isInitializing: false\r\n};\r\n\r\nexport function sdk(state = initialState, action) {\r\n  switch (action.type) {\r\n    case INITIALIZE_REQUEST:\r\n      return {\r\n        ...state,\r\n        isInitializing: true\r\n      };\r\n\r\n    case INITIALIZE_SUCCESS:\r\n      return {\r\n        ...state,\r\n        isInitialized: true,\r\n        isInitializing: false\r\n      };\r\n\r\n    case INITIALIZE_FAILURE:\r\n      return {\r\n        ...state,\r\n        isInitializing: false,\r\n        initializationError: action.payload\r\n      };\r\n\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n","import { combineReducers } from \"redux\";\n\nimport { call } from \"./call/resolver\";\nimport { devices } from \"./devices/resolver\";\nimport { sdk } from \"./sdk/resolver\";\n\nexport const jabraReducer = combineReducers({\n  sdk,\n  call,\n  devices\n});\n","import { applyFlexMiddleware, FlexReducer } from \"@twilio/flex-ui\";\nimport { applyMiddleware, combineReducers, compose, createStore } from \"redux\";\nimport thunk from \"redux-thunk\";\n\nimport { jabraReducer } from \"./reducer\";\n\nexport * from \"./actions\";\n\nexport const store = createStore(\n  combineReducers({\n    jabra: jabraReducer,\n    flex: FlexReducer\n  }),\n  compose(\n    applyMiddleware(thunk),\n    applyFlexMiddleware()\n  )\n);\n","import styled from \"styled-components\";\n\nexport const Device = styled.label`\n  display: flex;\n  align-items: center;\n  user-select: none;\n\n  &:not(:first-child) {\n    margin-top: 0.5rem;\n  }\n`;\n\nexport const Input = styled.input`\n  margin-right: 1rem;\n`;\n","import React from \"react\";\nimport { connect } from \"react-redux\";\n\nimport { setActiveDevice } from \"../../store\";\nimport * as S from \"./styles\";\n\nclass DeviceSelector extends React.Component {\n  handleChange = event => {\n    this.props.dispatch(setActiveDevice(event.target.value));\n  };\n\n  render() {\n    const { devices, activeDevice } = this.props;\n\n    if (!activeDevice) return null;\n\n    return (\n      <div>\n        {[...devices]\n          .sort((a, b) => a.deviceName.localeCompare(b.deviceName))\n          .map(device => (\n            <S.Device>\n              <S.Input\n                type=\"radio\"\n                value={device.deviceID}\n                name=\"active_device\"\n                checked={device.deviceID === activeDevice.deviceID}\n                onChange={this.handleChange}\n              />\n              {device.deviceName}\n            </S.Device>\n          ))}\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = ({ jabra }) => ({\n  devices: jabra.devices.items,\n  activeDevice: jabra.devices.active\n});\n\nexport default connect(mapStateToProps)(DeviceSelector);\n","import ReactTooltip from \"react-tooltip\";\r\nimport styled, { css } from \"styled-components\";\r\n\r\nimport UnstyledLogo from \"../Logo\";\r\n\r\nexport const Base = styled.div`\r\n  padding: 6px;\r\n  display: flex;\r\n  align-items: center;\r\n`;\r\n\r\nexport const Logo = styled(UnstyledLogo)`\r\n  height: 16px;\r\n\r\n  ${({ invalid }) =>\r\n    invalid &&\r\n    css`\r\n      filter: saturate(0%);\r\n    `}\r\n`;\r\n\r\nexport const Tooltip = styled(ReactTooltip).attrs({\r\n  delayHide: 100,\r\n  effect: \"solid\",\r\n  place: \"bottom\"\r\n})`\r\n  max-width: 16rem !important;\r\n  pointer-events: auto !important;\r\n  padding: 1rem !important;\r\n\r\n  &:hover {\r\n    visibility: visible !important;\r\n    opacity: 1 !important;\r\n  }\r\n`;\r\n\r\nexport const Error = styled.div`\r\n  text-align: center;\r\n`;\r\n","import React from \"react\";\n\nconst Logo = props => {\n  return (\n    <svg\n      {...props}\n      xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox=\"0 0 472.6 160.9\"\n    >\n      <path\n        fill=\"#FFD100\"\n        d=\"M143.8 75.7c-11 0-11 2.6-11 3.8v2.1c0 1.1 0 3.7 11 3.7s11-2.6 11-3.7v-2.1c-.1-1.2-.1-3.8-11-3.8zM210.8 81.5V64.7c0-1.1 0-3.7-11-3.7s-11 2.6-11 3.7v16.8c0 1.1 0 3.7 11 3.7s11-2.6 11-3.7zM283.9 85.3c11 0 11-2.6 11-3.7v-2.1c0-1.1 0-3.8-11-3.8s-11 2.6-11 3.8v2.1c0 1.1 0 3.7 11 3.7z\"\n      />\n      <path\n        fill=\"#FFD100\"\n        d=\"M462.6 0H10.1C4.5 0 0 4.5 0 10.1v140.8c0 5.6 4.5 10.1 10.1 10.1h452.5c5.6 0 10.1-4.5 10.1-10.1V10.1C472.6 4.5 468.1 0 462.6 0zM261 77.5c0-2.6 0-7.7 22.8-7.7 4.5 0 8.1.2 11 .5v-5.6c0-1.1 0-3.7-11-3.7-10.1 0-10.1 2.6-10.1 3.7 0 .8-.6 1.4-1.4 1.4h-9.1c-.8 0-1.4-.6-1.4-1.4v-1.9c0-2.6 0-7.7 22-7.7 22.8 0 22.8 5.1 22.8 7.7v20.7c0 2.6 0 7.7-22.8 7.7S261 86.1 261 83.5v-6zM70.4 119.9c0 .5-.4.8-.8.8h-3.4c-.5 0-.8-.4-.8-.8v-8.4c0-.5.4-.8.8-.8h3.4c.5 0 .8.4.8.8v8.4zm16.9-.1c0 .5-.4.9-.9.9h-3.9c-.5 0-.9-.4-.9-.9v-8.3c0-.5.4-.9.9-.9h3.9c.5 0 .9.4.9.9v8.3zm17 0c0 .5-.4.9-.9.9h-4.5c-.5 0-.9-.4-.9-.9v-8.2c0-.5.4-.9.9-.9h4.5c.5 0 .9.4.9.9v8.2zm6.7-36.3c0 2.6 0 7.7-22.8 7.7s-22.8-5.1-22.8-7.7V80c0-.8.6-1.4 1.4-1.4h9.1c.8 0 1.4.6 1.4 1.4v1.8c0 1.2.4 3.6 11 3.6 11 0 11-2.6 11-3.7V41.8c0-.8.6-1.4 1.4-1.4h9.1c.8 0 1.4.6 1.4 1.4l-.2 41.7zm10.3 36.2c0 .5-.4.9-.9.9h-5c-.5 0-.9-.4-.9-.9v-8.2c0-.5.4-.9.9-.9h5c.5 0 .9.4.9.9v8.2zm16.9 0c0 .5-.4 1-1 1h-5.6c-.5 0-1-.4-1-1v-8.1c0-.5.4-1 1-1h5.6c.5 0 1 .4 1 1v8.1zm-17.3-36.2v-6c0-2.6 0-7.7 22.8-7.7 4.5 0 8.1.2 11 .5v-5.6c0-1.1 0-3.7-11-3.7-10.2 0-10.2 2.6-10.2 3.7 0 .8-.6 1.4-1.4 1.4H123c-.8 0-1.4-.6-1.4-1.4v-1.9c0-2.6 0-7.7 22-7.7 22.8 0 22.8 5.1 22.8 7.7v20.7c0 2.6 0 7.7-22.8 7.7-22.7 0-22.7-5.1-22.7-7.7zm34.3 36.2c0 .6-.5 1-1 1h-6.1c-.6 0-1-.5-1-1v-8c0-.6.5-1 1-1h6.1c.6 0 1 .5 1 1v8zm17-.1c0 .6-.5 1.1-1.1 1.1h-6.7c-.6 0-1.1-.5-1.1-1.1v-7.9c0-.6.5-1.1 1.1-1.1h6.7c.6 0 1.1.5 1.1 1.1v7.9zm4.8-36.2V41.7c0-.8.6-1.4 1.4-1.4h9.1c.8 0 1.4.6 1.4 1.4v13.8c2.9-.3 6.5-.5 11-.5 22.8 0 22.8 5.1 22.8 7.7v20.7c0 2.6 0 7.7-22.8 7.7-22.9.1-22.9-5.1-22.9-7.7zm12.1 36.2c0 .6-.5 1.1-1.1 1.1h-7.2c-.6 0-1.1-.5-1.1-1.1v-7.9c0-.6.5-1.1 1.1-1.1h7.2c.6 0 1.1.5 1.1 1.1v7.9zm17-.1c0 .6-.5 1.1-1.1 1.1h-7.8c-.6 0-1.1-.5-1.1-1.1v-7.8c0-.6.5-1.1 1.1-1.1h7.8c.6 0 1.1.5 1.1 1.1v7.8zm17 0c0 .7-.5 1.2-1.2 1.2h-8.3c-.7 0-1.2-.5-1.2-1.2v-7.7c0-.7.5-1.2 1.2-1.2h8.3c.7 0 1.2.5 1.2 1.2v7.7zm17 0c0 .7-.5 1.2-1.2 1.2H230c-.7 0-1.2-.5-1.2-1.2v-7.6c0-.7.5-1.2 1.2-1.2h8.8c.7 0 1.2.5 1.2 1.2v7.6zm4.8-30.5c0 .8-.6 1.4-1.4 1.4h-9.1c-.8 0-1.4-.6-1.4-1.4V62.8c0-2.6 0-7.7 22.8-7.7.8 0 1.4.6 1.4 1.4v3.1c0 .8-.6 1.4-1.4 1.4-11 0-11 2.6-11 3.7V89zm121.5 29.5c0 1.2-1 2.2-2.2 2.2H247.3c-1.2 0-2.2-1-2.2-2.2v-5.6c0-1.2 1-2.2 2.2-2.2h116.9c1.2 0 2.2 1 2.2 2.2v5.6zm.1-46.4c0 1.6-1.3 2.9-2.9 2.9H349c-9.9 0-17.9-8.3-17.4-18.3.4-9.3 8.3-16.6 17.7-16.6h14.3c1.6 0 2.9 1.3 2.9 3 0 1.6-1.4 2.9-3 2.9H349c-6.2 0-11.3 4.9-11.6 11-.4 6.7 5.1 12.3 11.8 12.3h10.7c.4 0 .7-.3.7-.7v-7.3c0-.4-.3-.7-.7-.7h-5.1c-1.6 0-2.9-1.3-2.9-3 0-1.6 1.4-2.9 3-2.9h8.6c1.6 0 2.9 1.3 2.9 2.9v14.5zm40.6-.1c0 1-.5 2.1-1.4 2.6-.5.3-1 .4-1.5.4-.8 0-1.5-.3-2.1-.9L379 51c-.3-.3-.9-.1-.9.4V72c0 1.6-1.3 3-2.9 3-1.6 0-3-1.3-3-2.9v-29c0-1 .5-2 1.4-2.5 1.2-.7 2.7-.5 3.6.4l23.2 23.2c.3.3.9.1.9-.4V43.1c0-1.6 1.3-3 2.8-3 1.6 0 3 1.3 3 2.9v29z\"\n      />\n      <path\n        fill=\"#212721\"\n        d=\"M255.9 61c.8 0 1.4-.6 1.4-1.4v-3.1c0-.8-.6-1.4-1.4-1.4-22.8 0-22.8 5.1-22.8 7.7V89c0 .8.6 1.4 1.4 1.4h9.1c.8 0 1.4-.6 1.4-1.4V64.7c-.1-1.1-.1-3.7 10.9-3.7zM166.6 83.5V62.8c0-2.6 0-7.7-22.8-7.7-22 0-22 5.1-22 7.7v1.9c0 .8.6 1.4 1.4 1.4h9.1c.8 0 1.4-.6 1.4-1.4 0-1.1 0-3.7 10.2-3.7 11 0 11 2.6 11 3.7v5.6c-2.9-.3-6.5-.5-11-.5-22.8 0-22.8 5.1-22.8 7.7v6c0 2.6 0 7.7 22.8 7.7 22.7 0 22.7-5.1 22.7-7.7zm-11.9-2c0 1.1 0 3.7-11 3.7s-11-2.6-11-3.7v-2.1c0-1.1 0-3.8 11-3.8s11 2.6 11 3.8v2.1zM222.6 83.4V62.8c0-2.6 0-7.7-22.8-7.7-4.5 0-8.1.2-11 .5V41.7c0-.8-.6-1.4-1.4-1.4h-9.1c-.8 0-1.4.6-1.4 1.4v41.7c0 2.6 0 7.7 22.8 7.7 22.9.1 22.9-5.1 22.9-7.7zm-33.7-1.9V64.7c0-1.1 0-3.7 11-3.7s11 2.6 11 3.7v16.8c0 1.1 0 3.7-11 3.7s-11-2.6-11-3.7zM283.9 91.2c22.8 0 22.8-5.1 22.8-7.7V62.8c0-2.6 0-7.7-22.8-7.7-22 0-22 5.1-22 7.7v1.9c0 .8.6 1.4 1.4 1.4h9.1c.8 0 1.4-.6 1.4-1.4 0-1.1 0-3.7 10.1-3.7 11 0 11 2.6 11 3.7v5.6c-2.9-.3-6.5-.5-11-.5-22.8 0-22.8 5.1-22.8 7.7v6c-.1 2.6-.1 7.7 22.8 7.7zm-11-11.8c0-1.1 0-3.8 11-3.8s11 2.6 11 3.8v2.1c0 1.1 0 3.7-11 3.7s-11-2.6-11-3.7v-2.1zM109.5 40.4h-9.1c-.8 0-1.4.6-1.4 1.4v39.8c0 1.1 0 3.7-11 3.7-10.5 0-10.9-2.4-11-3.6v-1.8c0-.8-.6-1.4-1.4-1.4h-9.1c-.8 0-1.4.6-1.4 1.4v3.5c0 2.6 0 7.7 22.8 7.7s22.8-5.1 22.8-7.7V41.7c.3-.7-.4-1.3-1.2-1.3zM69.5 110.6h-3.4c-.5 0-.8.4-.8.8v8.4c0 .5.4.8.8.8h3.4c.5 0 .8-.4.8-.8v-8.4c.1-.4-.3-.8-.8-.8zM86.5 110.6h-3.9c-.5 0-.9.4-.9.9v8.3c0 .5.4.9.9.9h3.9c.5 0 .9-.4.9-.9v-8.3c-.1-.5-.5-.9-.9-.9zM103.4 110.6h-4.5c-.5 0-.9.4-.9.9v8.2c0 .5.4.9.9.9h4.5c.5 0 .9-.4.9-.9v-8.2c0-.5-.4-.9-.9-.9zM120.3 110.6h-5c-.5 0-.9.4-.9.9v8.2c0 .5.4.9.9.9h5c.5 0 .9-.4.9-.9v-8.2c.1-.5-.4-.9-.9-.9zM137.3 110.6h-5.6c-.5 0-1 .4-1 1v8.1c0 .5.4 1 1 1h5.6c.5 0 1-.4 1-1v-8.1c-.1-.5-.5-1-1-1zM154.2 110.6h-6.1c-.6 0-1 .5-1 1v8c0 .6.5 1 1 1h6.1c.6 0 1-.5 1-1v-8c0-.5-.5-1-1-1zM171.1 110.6h-6.7c-.6 0-1.1.5-1.1 1.1v7.9c0 .6.5 1.1 1.1 1.1h6.7c.6 0 1.1-.5 1.1-1.1v-7.9c0-.6-.5-1.1-1.1-1.1zM188 110.6h-7.2c-.6 0-1.1.5-1.1 1.1v7.9c0 .6.5 1.1 1.1 1.1h7.2c.6 0 1.1-.5 1.1-1.1v-7.9c0-.6-.4-1.1-1.1-1.1zM205 110.6h-7.8c-.6 0-1.1.5-1.1 1.1v7.8c0 .6.5 1.1 1.1 1.1h7.8c.6 0 1.1-.5 1.1-1.1v-7.8c0-.6-.5-1.1-1.1-1.1zM221.9 110.6h-8.3c-.7 0-1.2.5-1.2 1.2v7.7c0 .7.5 1.2 1.2 1.2h8.3c.7 0 1.2-.5 1.2-1.2v-7.7c0-.6-.5-1.2-1.2-1.2zM238.8 110.6H230c-.7 0-1.2.5-1.2 1.2v7.6c0 .7.5 1.2 1.2 1.2h8.8c.7 0 1.2-.5 1.2-1.2v-7.6c.1-.6-.5-1.2-1.2-1.2zM364.2 110.6H247.3c-1.2 0-2.2 1-2.2 2.2v5.6c0 1.2 1 2.2 2.2 2.2h116.9c1.2 0 2.2-1 2.2-2.2v-5.6c0-1.2-1-2.2-2.2-2.2zM404.2 40.1c-1.6 0-2.8 1.4-2.8 3v20.6c0 .5-.6.7-.9.4L377.2 41c-.9-.9-2.4-1.1-3.6-.4-.9.5-1.4 1.5-1.4 2.5v29c0 1.6 1.3 2.9 3 2.9 1.6 0 2.9-1.4 2.9-3V51.4c0-.5.6-.7.9-.4l23.2 23.2c.6.6 1.3.9 2.1.9.5 0 1-.1 1.5-.4.9-.5 1.4-1.5 1.4-2.6V43c-.1-1.6-1.4-2.9-3-2.9zM363.5 54.7h-8.6c-1.6 0-3 1.3-3 2.9 0 1.6 1.3 3 2.9 3h5.1c.4 0 .7.3.7.7v7.3c0 .4-.3.7-.7.7h-10.7c-6.8 0-12.2-5.5-11.8-12.3.3-6.1 5.4-11 11.6-11h14.4c1.6 0 3-1.3 3-2.9 0-1.6-1.3-3-2.9-3h-14.3c-9.3 0-17.2 7.3-17.7 16.6-.5 10 7.5 18.3 17.4 18.3h14.5c1.6 0 2.9-1.3 2.9-2.9V57.6c.2-1.6-1.1-2.9-2.8-2.9z\"\n      />\n    </svg>\n  );\n};\n\nexport default Logo;\n","import React from \"react\";\r\nimport { connect } from \"react-redux\";\r\n\r\nimport DeviceSelector from \"../DeviceSelector\";\r\nimport * as S from \"./styles\";\r\n\r\nconst Device = ({\r\n  store,\r\n  devices,\r\n  activeDevice,\r\n  isInitialized,\r\n  isInitializing\r\n}) => {\r\n  let invalid;\r\n\r\n  if (isInitializing) {\r\n    invalid = \"Browser SDK initializing...\";\r\n  } else if (!isInitialized) {\r\n    invalid = \"Browser SDK installation incomplete. Please (re)install\";\r\n  } else if (devices.length < 1 || !activeDevice) {\r\n    invalid = \"Couldn't find any Jabra devices\";\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <S.Base>\r\n        <S.Logo data-tip data-for=\"jabra-device\" invalid={invalid} />\r\n      </S.Base>\r\n      <S.Tooltip id=\"jabra-device\">\r\n        {invalid ? (\r\n          <S.Error>{invalid}</S.Error>\r\n        ) : (\r\n          <DeviceSelector store={store}></DeviceSelector>\r\n        )}\r\n      </S.Tooltip>\r\n    </React.Fragment>\r\n  );\r\n};\r\n\r\nconst mapStateToProps = ({ jabra }) => ({\r\n  isInitialized: jabra.sdk.isInitialized,\r\n  isInitializing: jabra.sdk.isInitializing,\r\n  devices: jabra.devices.items,\r\n  devices: jabra.devices.items,\r\n  activeDevice: jabra.devices.active\r\n});\r\n\r\nexport default connect(mapStateToProps)(Device);\r\n","import { FlexPlugin } from \"flex-plugin\";\r\nimport * as jabra from \"@gnaudio/jabra-browser-integration\";\r\nimport React from \"react\";\r\n\r\nimport CallControl from \"./components/CallControl\";\r\nimport DeviceIndicator from \"./components/DeviceIndicator\";\r\nimport { initialize, loadDevices, setCallState, store } from \"./store\";\r\n\r\nexport class Plugin extends FlexPlugin {\r\n  constructor() {\r\n    super(\"JabraCallControl\");\r\n  }\r\n\r\n  init(flex, manager) {\r\n    this.flex = flex;\r\n    this.manager = manager;\r\n\r\n    store.dispatch(initialize());\r\n\r\n    jabra.addEventListener(\"device attached\", () => {\r\n      store.dispatch(loadDevices());\r\n    });\r\n\r\n    jabra.addEventListener(\"device detached\", () => {\r\n      store.dispatch(loadDevices());\r\n    });\r\n\r\n    manager.workerClient.reservations.forEach(this.handleReservation);\r\n    manager.workerClient.on(\"reservationCreated\", this.handleReservation);\r\n\r\n    flex.MainHeader.Content.add(\r\n      <DeviceIndicator key=\"jabra-device-indicator\" store={store} />,\r\n      {\r\n        align: \"end\",\r\n        sortOrder: -1\r\n      }\r\n    );\r\n\r\n    flex.RootContainer.Content.add(\r\n      <CallControl key=\"jabra-call-control\" store={store} />\r\n    );\r\n  }\r\n\r\n  handleReservation = reservation => {\r\n    if (reservation.task.taskChannelUniqueName !== \"voice\") return;\r\n\r\n    if ([\"pending\"].includes(reservation.status))\r\n      this.handleCallIncoming(reservation);\r\n\r\n    if ([\"wrapping\"].includes(reservation.status))\r\n      this.handleCallWrapping(reservation);\r\n\r\n    reservation.on(\"accepted\", this.handleCallAccepted);\r\n    reservation.on(\"wrapup\", this.handleCallWrapping);\r\n    reservation.on(\"completed\", this.handleCallCompleted);\r\n    reservation.on(\"canceled\", this.handleCallCanceled);\r\n    reservation.on(\"rescinded\", this.handleCallRescinded);\r\n  };\r\n\r\n  handleCallIncoming = reservation => {\r\n    jabra.addEventListener(\"acceptcall\", () => {\r\n      this.flex.Actions.invokeAction(\"AcceptTask\", {\r\n        sid: reservation.sid\r\n      });\r\n      this.flex.Actions.invokeAction(\"SelectTask\", {\r\n        sid: reservation.sid\r\n      });\r\n    });\r\n\r\n    store.dispatch(setCallState(\"incoming\"));\r\n  };\r\n\r\n  handleCallAccepted = reservation => {\r\n    const connection = this.manager.voiceClient.activeConnection();\r\n\r\n    connection.on(\"mute\", muted => {\r\n      if (muted) jabra.mute();\r\n      else jabra.unmute();\r\n    });\r\n\r\n    jabra.addEventListener(\"endcall\", () => {\r\n      connection.disconnect();\r\n    });\r\n\r\n    jabra.addEventListener(\"mute\", () => {\r\n      this.manager.voiceClient.activeConnection().mute(true);\r\n    });\r\n\r\n    jabra.addEventListener(\"unmute\", () => {\r\n      this.manager.voiceClient.activeConnection().mute(false);\r\n    });\r\n\r\n    store.dispatch(setCallState(\"accepted\", reservation));\r\n  };\r\n\r\n  handleCallWrapping = reservation => {\r\n    store.dispatch(setCallState(\"wrapping\", reservation));\r\n  };\r\n\r\n  handleCallCompleted = reservation => {\r\n    store.dispatch(setCallState(\"none\", reservation));\r\n  };\r\n\r\n  handleCallCanceled = reservation => {\r\n    store.dispatch(setCallState(\"none\", reservation));\r\n  };\r\n\r\n  handleCallRescinded = reservation => {\r\n    store.dispatch(setCallState(\"none\", reservation));\r\n  };\r\n}\r\n"],"names":["connect","available","flex","worker","activity","callState","activeDevice","jabra","CallControl","React","CallState","call","state","devices","active","SET_CALL_STATE","setCallState","type","payload","initialState","reservation","LOAD_DEVICES","SET_ACTIVE_DEVICE","REMOVE_ACTIVE_DEVICE","loadDevices","dispatch","getState","device","setActiveDevice","deviceID","some","length","removeActiveDevice","status","id","window","location","protocol","manager","Flex","getInstance","audio","deviceInfo","voiceClient","setInputDevice","browserAudioInputId","speakerDevices","set","browserAudioOutputId","items","INITIALIZE_REQUEST","INITIALIZE_FAILURE","INITIALIZE_SUCCESS","initialize","isInitialized","isInitializing","jabraReducer","combineReducers","sdk","action","initializationError","store","createStore","FlexReducer","compose","applyMiddleware","thunk","applyFlexMiddleware","Device","styled","label","Input","input","DeviceSelector","event","props","target","value","Component","this","_toConsumableArray","sort","a","b","deviceName","localeCompare","map","S.Device","S.Input","name","checked","onChange","_this2","handleChange","Base","div","Logo","xmlns","viewBox","fill","d","invalid","css","Tooltip","ReactTooltip","attrs","delayHide","effect","place","Error","Fragment","S.Base","S.Logo","S.Tooltip","S.Error","Plugin","task","taskChannelUniqueName","includes","_this","handleCallIncoming","handleCallWrapping","on","handleCallAccepted","handleCallCompleted","handleCallCanceled","handleCallRescinded","Actions","invokeAction","sid","connection","activeConnection","muted","disconnect","mute","FlexPlugin","workerClient","reservations","forEach","handleReservation","MainHeader","Content","add","DeviceIndicator","key","align","sortOrder","RootContainer"],"mappings":"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"}